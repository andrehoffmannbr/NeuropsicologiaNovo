<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Sistema de Gestão de Clínica de Neuropsicologia">
  <meta name="author" content="Sistema de Neuropsicologia">
  <title>Sistema de Neuropsicologia</title>
  
  <!-- Preconnect para performance -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  
  <!-- Lucide Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lucide@latest/dist/umd/lucide.css">
  
  <!-- CSP Meta Tag -->
  <meta http-equiv="Content-Security-Policy" content="
    default-src 'self';
    script-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net;
    style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://cdn.jsdelivr.net;
    font-src 'self' https://fonts.gstatic.com;
    img-src 'self' data: https:;
    connect-src 'self' https://viiukipyuimjandushqh.supabase.co wss://viiukipyuimjandushqh.supabase.co;
  ">
  
  <!-- Favicon -->
  <link rel="icon" type="image/svg+xml" href="/favicon.svg">
</head>
<body>
  <div id="initial-loading" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #f8fafc; display: flex; align-items: center; justify-content: center; z-index: 9999;">
    <div style="text-align: center;">
      <div style="width: 40px; height: 40px; border: 3px solid #e2e8f0; border-top: 3px solid #3b82f6; border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto 16px;"></div>
      <p style="color: #64748b; font-family: system-ui, -apple-system, sans-serif;">Carregando Sistema de Neuropsicologia...</p>
    </div>
  </div>
  
  <div id="app"></div>
  
  <!-- TESTE DIRETO NO HTML -->
  <script>
    console.log('🚨 TESTE DIRETO NO HTML - FUNCIONANDO!');
    console.log('🚨 Timestamp HTML:', new Date().toLocaleString());
    
    // Função para adicionar aba colaboradores
    function adicionarAbaColaboradores() {
      var navTabs = document.querySelector('#nav-tabs');
      console.log('🚨 Nav tabs encontrado:', navTabs);
      
      if (navTabs) {
        // Verificar se já existe
        var existingTab = navTabs.querySelector('[data-section="colaboradores"]');
        if (existingTab) {
          console.log('🚨 Aba colaboradores já existe, removendo...');
          existingTab.remove();
        }
        
        // Criar nova aba
        var colaboradoresTab = document.createElement('button');
        colaboradoresTab.className = 'nav-tab';
        colaboradoresTab.setAttribute('data-section', 'colaboradores');
        colaboradoresTab.style.cssText = `
          background: #10b981 !important;
          color: white !important;
          display: flex !important;
          align-items: center !important;
          gap: 6px !important;
          padding: 8px 10px !important;
          border: none !important;
          border-radius: 6px !important;
          font-size: 11px !important;
          font-weight: 600 !important;
          cursor: pointer !important;
          transition: all 0.2s !important;
          margin: 2px !important;
          white-space: nowrap !important;
          flex-shrink: 0 !important;
          min-width: auto !important;
          border-bottom: 3px solid transparent !important;
        `;
        
        colaboradoresTab.innerHTML = `
          <i data-lucide="users-cog" style="width: 12px; height: 12px; flex-shrink: 0;"></i>
          <span class="nav-tab-text" style="font-size: 11px; font-weight: 600;">Colaboradores</span>
        `;
        
        // Adicionar evento de clique
        colaboradoresTab.addEventListener('click', function() {
          console.log('🚨 Aba colaboradores clicada!');
          
          // Fechar menu mobile se estiver aberto
          var navToggle = document.querySelector('#nav-toggle');
          var navTabs = document.querySelector('#nav-tabs');
          if (navToggle && navTabs) {
            navToggle.classList.remove('active');
            navTabs.classList.remove('open');
          }
          
          // Simular navegação
          window.dispatchEvent(new CustomEvent('dashboard-section-change', {
            detail: { section: 'colaboradores' }
          }));
        });
        
        // Adicionar ao nav
        navTabs.appendChild(colaboradoresTab);
        console.log('🚨 ABA COLABORADORES ADICIONADA COM SUCESSO!');
        
        // Recriar ícones
        if (window.lucide) {
          window.lucide.createIcons();
        }
        
        // Verificar se foi adicionada
        setTimeout(function() {
          var verificacao = document.querySelector('[data-section="colaboradores"]');
          console.log('🚨 Verificação da aba:', verificacao);
          if (verificacao) {
            console.log('🚨 ✅ ABA COLABORADORES CONFIRMADA!');
          } else {
            console.log('🚨 ❌ ABA COLABORADORES NÃO ENCONTRADA!');
          }
        }, 500);
        
        return true;
      } else {
        console.log('🚨 Nav tabs não encontrado');
        return false;
      }
    }
    
    // Adicionar aba colaboradores quando a página carregar
    window.addEventListener('load', function() {
      console.log('🚨 WINDOW LOAD - Procurando nav-tabs...');
      
      setTimeout(function() {
        if (!adicionarAbaColaboradores()) {
          // Tentar novamente em intervalos se não conseguir
          var tentativas = 0;
          var interval = setInterval(function() {
            tentativas++;
            console.log('🚨 Tentativa', tentativas, '- Procurando nav-tabs...');
            
            if (adicionarAbaColaboradores()) {
              console.log('🚨 ABA COLABORADORES ADICIONADA NA TENTATIVA', tentativas);
              clearInterval(interval);
            } else if (tentativas >= 10) {
              console.log('🚨 Desistindo após 10 tentativas');
              clearInterval(interval);
            }
          }, 1000);
        }
      }, 2000);
    });
    
    // Também tentar quando o DOM mudar
    if (window.MutationObserver) {
      var observer = new MutationObserver(function(mutations) {
        mutations.forEach(function(mutation) {
          if (mutation.type === 'childList' && mutation.addedNodes.length > 0) {
            for (var i = 0; i < mutation.addedNodes.length; i++) {
              var node = mutation.addedNodes[i];
              if (node.nodeType === 1 && (node.id === 'nav-tabs' || node.querySelector('#nav-tabs'))) {
                console.log('🚨 Nav tabs detectado via MutationObserver');
                setTimeout(adicionarAbaColaboradores, 500);
                break;
              }
            }
          }
        });
      });
      
      observer.observe(document.body, { childList: true, subtree: true });
    }
  </script>
  
  <style>
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  </style>
  
  <script type="module" src="/src/main.js"></script>
</body>
</html> 